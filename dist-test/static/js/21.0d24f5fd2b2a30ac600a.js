webpackJsonp([21],{LHAr:function(r,t,o){var a=o("WbfX");"string"==typeof a&&(a=[[r.i,a,""]]),a.locals&&(r.exports=a.locals);o("rjj0")("c2246662",a,!1,{})},WbfX:function(r,t,o){(r.exports=o("FZ+f")(!0)).push([r.i,"\n.inputbox {\r\n  margin-top: 50px;\n}\n#workerss {\r\n  width: 50%;\n}\r\n","",{version:3,sources:["D:/my-vue-webpack/utc-vue-webpack/src/views/admin/src/views/admin/simulation-gantt.vue"],names:[],mappings:";AAoIA;EACA,iBAAA;CACA;AACA;EACA,WAAA;CACA",file:"simulation-gantt.vue",sourcesContent:['<template>\r\n  <div>\r\n    <el-row :gutter="20" class="inputbox">\r\n      <el-col :span="4">\r\n        <el-input placeholder="请输入地区系数" v-model="input" clearable></el-input>\r\n      </el-col>\r\n      <el-col :span="4">\r\n        <div class="grid-content bg-purple-light"></div>\r\n        <div class="block">\r\n          <el-date-picker\r\n            v-model="sch_date"\r\n            type="date"\r\n            placeholder="选择日期"\r\n            value-format="yyyy-MM-dd"\r\n          ></el-date-picker>\r\n        </div>\r\n      </el-col>\r\n      <el-col :span="4">\r\n        <el-button type="primary" class="add" @click="calculatePath()">查询</el-button>\r\n      </el-col>\r\n    </el-row>\r\n    <div id="workerss"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from "axios";\r\nexport default {\r\n  name: "ShowDists",\r\n  data() {\r\n    return {\r\n      input: "",\r\n      colors: [],\r\n      sch_date: ""\r\n    };\r\n  },\r\n  mounted() {},\r\n  methods: {\r\n    calculatePath() {\r\n      var _that = this;\r\n      var workers = [];\r\n      var jobs = [];\r\n      var obj = {};\r\n\r\n      _that.$axios\r\n        .post(_that.$api + "/api/sch/data_by_region_date", {\r\n          workday: _that._data.sch_date,\r\n          region_id: _that._data.input\r\n        })\r\n        .then(res => {\r\n          if (res.data.job_list.length !== 0) {\r\n            for (var i = 0; i < res.data.job_list.length; i++) {\r\n              obj.startDate = new Date(res.data.job_list[i].start_time);\r\n              obj.endDate = new Date(res.data.job_list[i].end_time);\r\n              obj.taskName = res.data.job_list[i].worker_id;\r\n              obj.status = _that._data.colors[obj.taskName];\r\n              jobs.push(obj);\r\n              obj = {};\r\n            }\r\n            for (var i = 0; i < res.data.worker_list.length; i++) {\r\n              workers.push(res.data.worker_list[i].worker_id);\r\n            }\r\n            _that.playgantt(jobs, workers);\r\n          } else {\r\n            this.$message({\r\n              showClose: true,\r\n              message: "所选日期没有单!"\r\n            });\r\n          }\r\n        });\r\n    },\r\n    getNowFormatDate() {\r\n      var date = new Date();\r\n      var seperator1 = "-";\r\n      var year = date.getFullYear();\r\n      var month = date.getMonth() + 1;\r\n      var strDate = date.getDate();\r\n      if (month >= 1 && month <= 9) {\r\n        month = "0" + month;\r\n      }\r\n      if (strDate >= 0 && strDate <= 9) {\r\n        strDate = "0" + strDate;\r\n      }\r\n      var currentdate = year + seperator1 + month + seperator1 + strDate;\r\n      return currentdate;\r\n    },\r\n    playgantt(jobs, workers) {\r\n      var tasks = jobs;\r\n      setTimeout(function() {\r\n        var taskStatus = {\r\n          color1: "color1",\r\n          color2: "color2",\r\n          color3: "color3",\r\n          color4: "color4",\r\n          color5: "color5",\r\n          color6: "color6",\r\n          color7: "color7",\r\n          color8: "color8",\r\n          color9: "color9",\r\n          color10: "color10",\r\n          color11: "color11",\r\n          color12: "color12",\r\n          color13: "color13",\r\n          color14: "color14",\r\n          color15: "color15",\r\n          color16: "color16",\r\n          color17: "color17"\r\n        };\r\n        var taskNames = workers;\r\n        tasks.sort(function(a, b) {\r\n          return a.endDate - b.endDate;\r\n        });\r\n        var maxDate = tasks[tasks.length - 1].endDate;\r\n        tasks.sort(function(a, b) {\r\n          return a.startDate - b.startDate;\r\n        });\r\n        var minDate = tasks[0].startDate;\r\n\r\n        var format = "%H:%M";\r\n\r\n        var gantt = d3\r\n          .gantt()\r\n          .taskTypes(taskNames)\r\n          .taskStatus(taskStatus)\r\n          .tickFormat(format);\r\n        gantt(tasks);\r\n      }, 2000);\r\n    }\r\n  }\r\n};\r\n<\/script>\r\n<style>\r\n.inputbox {\r\n  margin-top: 50px;\r\n}\r\n#workerss {\r\n  width: 50%;\r\n}\r\n</style>\r\n'],sourceRoot:""}])},dtqd:function(r,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});o("mtWM");var a={name:"ShowDists",data:function(){return{input:"",colors:[],sch_date:""}},mounted:function(){},methods:{calculatePath:function(){var r=this,t=this,o=[],a=[],n={};t.$axios.post(t.$api+"/api/sch/data_by_region_date",{workday:t._data.sch_date,region_id:t._data.input}).then(function(e){if(0!==e.data.job_list.length){for(var s=0;s<e.data.job_list.length;s++)n.startDate=new Date(e.data.job_list[s].start_time),n.endDate=new Date(e.data.job_list[s].end_time),n.taskName=e.data.job_list[s].worker_id,n.status=t._data.colors[n.taskName],a.push(n),n={};for(s=0;s<e.data.worker_list.length;s++)o.push(e.data.worker_list[s].worker_id);t.playgantt(a,o)}else r.$message({showClose:!0,message:"所选日期没有单!"})})},getNowFormatDate:function(){var r=new Date,t=r.getFullYear(),o=r.getMonth()+1,a=r.getDate();return o>=1&&o<=9&&(o="0"+o),a>=0&&a<=9&&(a="0"+a),t+"-"+o+"-"+a},playgantt:function(r,t){var o=r;setTimeout(function(){var r=t;o.sort(function(r,t){return r.endDate-t.endDate});o[o.length-1].endDate;o.sort(function(r,t){return r.startDate-t.startDate});o[0].startDate;d3.gantt().taskTypes(r).taskStatus({color1:"color1",color2:"color2",color3:"color3",color4:"color4",color5:"color5",color6:"color6",color7:"color7",color8:"color8",color9:"color9",color10:"color10",color11:"color11",color12:"color12",color13:"color13",color14:"color14",color15:"color15",color16:"color16",color17:"color17"}).tickFormat("%H:%M")(o)},2e3)}}},n=function(){var r=this,t=r.$createElement,o=r._self._c||t;return o("div",[o("el-row",{staticClass:"inputbox",attrs:{gutter:20}},[o("el-col",{attrs:{span:4}},[o("el-input",{attrs:{placeholder:"请输入地区系数",clearable:""},model:{value:r.input,callback:function(t){r.input=t},expression:"input"}})],1),r._v(" "),o("el-col",{attrs:{span:4}},[o("div",{staticClass:"grid-content bg-purple-light"}),r._v(" "),o("div",{staticClass:"block"},[o("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:r.sch_date,callback:function(t){r.sch_date=t},expression:"sch_date"}})],1)]),r._v(" "),o("el-col",{attrs:{span:4}},[o("el-button",{staticClass:"add",attrs:{type:"primary"},on:{click:function(t){r.calculatePath()}}},[r._v("查询")])],1)],1),r._v(" "),o("div",{attrs:{id:"workerss"}})],1)};n._withStripped=!0;var e={render:n,staticRenderFns:[]},s=e;var l=!1;var c=o("VU/8")(a,s,!1,function(r){l||o("LHAr")},null,null);c.options.__file="src/views/admin/simulation-gantt.vue";t.default=c.exports}});
//# sourceMappingURL=21.0d24f5fd2b2a30ac600a.js.map
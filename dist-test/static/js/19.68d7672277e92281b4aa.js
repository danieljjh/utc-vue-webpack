webpackJsonp([19],{kfBU:function(r,t,n){(r.exports=n("FZ+f")(!0)).push([r.i,"\nh2[data-v-2ba5fe30] {\r\n  color: #b1afaf;\r\n  line-height: 80px;\r\n  text-align: left;\r\n  padding-left: 20px;\r\n  border-bottom: 1px solid #dee2e6;\r\n  -webkit-box-shadow: 0px 7px 7px -7px #5e5e5e;\r\n          box-shadow: 0px 7px 7px -7px #5e5e5e;\n}\n.todayclub[data-v-2ba5fe30] {\r\n  margin-top: 70px;\n}\n.el-row[data-v-2ba5fe30] {\r\n  margin-bottom: 20px;\n&:last-child {\r\n    margin-bottom: 0;\n}\n}\n.el-col[data-v-2ba5fe30] {\r\n  border-radius: 4px;\n}\n.block1[data-v-2ba5fe30] {\r\n  color: white;\r\n  background: #1b88e5;\n}\n.block2[data-v-2ba5fe30] {\r\n  color: white;\r\n  background: #7560ed;\n}\n.block3[data-v-2ba5fe30] {\r\n  color: white;\r\n  background: #26c5d8;\n}\n.h5[data-v-2ba5fe30] {\r\n  text-indent: 1em;\r\n  text-align: left;\r\n  font-size: 14px;\r\n  line-height: 40px;\r\n  margin: 0;\n}\n.ordernumber[data-v-2ba5fe30] {\r\n  font-size: 40px;\r\n  line-height: 60px;\n}\n.remarks[data-v-2ba5fe30] {\r\n  font-size: 12px;\n}\n#myChart[data-v-2ba5fe30] {\r\n  float: left;\n}\n#hourcontrast[data-v-2ba5fe30] {\r\n  float: right;\n}\r\n","",{version:3,sources:["D:/my-vue-webpack/utc-vue-webpack/src/views/admin/src/views/admin/index.vue"],names:[],mappings:";AAiUA;EACA,eAAA;EACA,kBAAA;EACA,iBAAA;EACA,mBAAA;EACA,iCAAA;EACA,6CAAA;UAAA,qCAAA;CACA;AAEA;EACA,iBAAA;CACA;AACA;EACA,oBAAA;AACA;IACA,iBAAA;CACA;CACA;AACA;EACA,mBAAA;CACA;AACA;EACA,aAAA;EACA,oBAAA;CACA;AACA;EACA,aAAA;EACA,oBAAA;CACA;AACA;EACA,aAAA;EACA,oBAAA;CACA;AACA;EACA,iBAAA;EACA,iBAAA;EACA,gBAAA;EACA,kBAAA;EACA,UAAA;CACA;AACA;EACA,gBAAA;EACA,kBAAA;CACA;AACA;EACA,gBAAA;CACA;AACA;EACA,YAAA;CACA;AACA;EACA,aAAA;CACA",file:"index.vue",sourcesContent:['\r\n\r\n<template>\r\n  <div class="home">\r\n    <h2>Welcome</h2>\r\n    <div class="todayclub">\r\n      <el-row type="flex" class="row-bg" justify="space-around">\r\n        <el-col :span="5" class="block1">\r\n          <h5 class="h5">总订单数</h5>\r\n          <div class="ordernumber">{{general_order}}</div>\r\n          <p class="remarks">GENERAL ORDER</p>\r\n        </el-col>\r\n        <el-col :span="5" class="block2">\r\n          <h5 class="h5">已派单数</h5>\r\n          <div class="ordernumber">{{sent_list}}</div>\r\n          <p class="remarks">SENT LIST</p>\r\n        </el-col>\r\n        <el-col :span="5" class="block3">\r\n          <h5 class="h5">待派单数</h5>\r\n          <div class="ordernumber">{{pending_number}}</div>\r\n          <p class="remarks">PENDING NUMBER</p>\r\n        </el-col>\r\n      </el-row>\r\n    </div>\r\n    <div class="echats">\r\n      <div id="myChart" :style="{width: \'50%\', height: \'600px\'}"></div>\r\n      <div id="hourcontrast" :style="{width: \'50%\', height: \'600px\'}"></div>\r\n    </div>\r\n    <div id="workerss"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: "AdminHome",\r\n  data() {\r\n    return {\r\n      colors: [\r\n        "color1",\r\n        "color2",\r\n        "color3",\r\n        "color4",\r\n        "color5",\r\n        "color6",\r\n        "color7",\r\n        "color8",\r\n        "color9",\r\n        "color10",\r\n        "color11",\r\n        "color12",\r\n        "color13",\r\n        "color14",\r\n        "color15",\r\n        "color16",\r\n        "color17"\r\n      ],\r\n      data: [99, 71, 78, 25, 36, 92],\r\n      line: "",\r\n      general_order: "123",\r\n      sent_list: "456",\r\n      pending_number: "789"\r\n    };\r\n  },\r\n  created() {},\r\n  mounted() {\r\n    this.Numberorders();\r\n    this.drawLine();\r\n    this.hourcontrast();\r\n    this.calculatePath();\r\n  },\r\n  methods: {\r\n    drawLine() {\r\n      // 基于准备好的dom，初始化echarts实例\r\n      let myChart = this.$echarts.init(document.getElementById("myChart"));\r\n      // 绘制图表\r\n      myChart.setOption({\r\n        title: {\r\n          text: "区域订单",\r\n          subtext: "工时需求",\r\n          x: "center"\r\n        },\r\n        tooltip: {\r\n          trigger: "item",\r\n          show: true\r\n        },\r\n        grid: {\r\n          // 控制图的大小，调整下面这些值就可以，\r\n          show: true,\r\n          left: "3%",\r\n          right: "4%",\r\n          bottom: "3%",\r\n          containLabel: true,\r\n          backgroundColor: "#e4e4e6",\r\n          x: 40,\r\n          x2: 100,\r\n          y2: 150 // y2可以控制 X轴跟Zoom控件之间的间隔，避免以为倾斜后造成 label重叠到zoom上\r\n        },\r\n        legend: {\r\n          data: ["销量"],\r\n          left: "10%",\r\n          top: "10%"\r\n        },\r\n        xAxis: {\r\n          type: "category",\r\n          data: [\r\n            "2019-03-1706:00:00",\r\n            "2019-03-17 07:00:00",\r\n            "2019-03-17 08:00:00",\r\n            "2019-03-17 09:00:00",\r\n            "2019-03-17 10:00:00",\r\n            "2019-03-1706:00:00",\r\n            "2019-03-17 07:00:00",\r\n            "2019-03-17 08:00:00",\r\n            "2019-03-17 09:00:00",\r\n            "2019-03-17 10:00:00"\r\n          ],\r\n\r\n          axisTick: {\r\n            alignWithLabel: true\r\n          },\r\n          splitLine: {\r\n            show: false,\r\n            interval: "auto",\r\n            lineStyle: {\r\n              color: ["#315070"],\r\n              width: 1,\r\n              type: "solid"\r\n            }\r\n          },\r\n          axisLabel: {\r\n            interval: 0,\r\n            rotate: 90\r\n          }\r\n        },\r\n        yAxis: {\r\n          type: "value"\r\n        },\r\n        series: [\r\n          {\r\n            name: "销量",\r\n            type: "bar",\r\n            data: [0.27, 0.76, 1.29, 1.94, 2.11, 0.27, 0.76, 1.29, 1.94, 2.11],\r\n            itemStyle: {\r\n              color: "#e54933"\r\n            }\r\n          }\r\n        ]\r\n      });\r\n    },\r\n    hourcontrast() {\r\n      // 基于准备好的dom，初始化echarts实例\r\n      var _that = this;\r\n      var data = [];\r\n      var date = {};\r\n      _that.$axios.get(_that.$api + "/api/sch/compare_worker_job").then(res => {\r\n        for (var k in res.data.jobs_hrs) {\r\n          date.product = k;\r\n          date.jobs_hrs = res.data.jobs_hrs[k];\r\n          date.workers_hrs = res.data.workers_hrs[k];\r\n          data.push(date);\r\n          date = {};\r\n        }\r\n      });\r\n      let myChart = this.$echarts.init(document.getElementById("hourcontrast"));\r\n      // 绘制图表\r\n      myChart.setOption({\r\n        title: {\r\n          text: "区域洗车",\r\n          subtext: "工时需求 和 工人工时",\r\n          x: "center"\r\n        },\r\n        grid: {\r\n          // 控制图的大小，调整下面这些值就可以，\r\n          show: true,\r\n          backgroundColor: "#e4e4e6",\r\n          x: 40,\r\n          x2: 100,\r\n          y2: 150 // y2可以控制 X轴跟Zoom控件之间的间隔，避免以为倾斜后造成 label重叠到zoom上\r\n        },\r\n\r\n        legend: {\r\n          left: "10%",\r\n          top: "10%"\r\n        },\r\n        tooltip: {\r\n          show: true\r\n        },\r\n        dataset: {\r\n          dimensions: ["product", "jobs_hrs", "workers_hrs"],\r\n          source: data\r\n        },\r\n        xAxis: {\r\n          type: "category",\r\n          axisTick: {\r\n            alignWithLabel: true\r\n          },\r\n          axisLabel: {\r\n            interval: 0,\r\n            rotate: 90\r\n          }\r\n        },\r\n        yAxis: {},\r\n        // Declare several bar series, each will be mapped\r\n        // to a column of dataset.source by default.\r\n        series: [\r\n          { type: "bar" },\r\n          {\r\n            type: "bar",\r\n            barGap: "0%",\r\n            itemStyle: {\r\n              color: "#1b88e5"\r\n            }\r\n          }\r\n        ]\r\n      });\r\n    },\r\n    calculatePath() {\r\n      var _that = this;\r\n      var date = _that.getNowFormatDate();\r\n      var workers = [];\r\n      var jobs = [];\r\n      var obj = {};\r\n      _that.$axios\r\n        .post(_that.$api + "/api/sch/load_by_region", {\r\n          workday: date\r\n        })\r\n        .then(res => {\r\n          if (res.data.jobs !== null) {\r\n            for (var i = 0; i < res.data.jobs.length; i++) {\r\n              obj.startDate = new Date(res.data.jobs[i].start_time);\r\n              obj.endDate = new Date(res.data.jobs[i].end_time);\r\n              obj.taskName = res.data.jobs[i].worker_id;\r\n              obj.status = _that._data.colors[obj.taskName];\r\n              jobs.push(obj);\r\n              obj = {};\r\n            }\r\n            for (var i = 0; i < res.data.workers.length; i++) {\r\n              workers.push(res.data.workers[i].worker_id);\r\n            }\r\n            _that.playgantt(jobs, workers);\r\n          } else {\r\n            this.$message({\r\n              showClose: true,\r\n              message: "今日无单!"\r\n            });\r\n          }\r\n        });\r\n    },\r\n    getNowFormatDate() {\r\n      var date = new Date();\r\n      var seperator1 = "-";\r\n      var year = date.getFullYear();\r\n      var month = date.getMonth() + 1;\r\n      var strDate = date.getDate();\r\n      if (month >= 1 && month <= 9) {\r\n        month = "0" + month;\r\n      }\r\n      if (strDate >= 0 && strDate <= 9) {\r\n        strDate = "0" + strDate;\r\n      }\r\n      var currentdate = year + seperator1 + month + seperator1 + strDate;\r\n      return currentdate;\r\n    },\r\n    playgantt(jobs, workers) {\r\n      var tasks = jobs;\r\n      setTimeout(function() {\r\n        var taskStatus = {\r\n          color1: "color1",\r\n          color2: "color2",\r\n          color3: "color3",\r\n          color4: "color4",\r\n          color5: "color5",\r\n          color6: "color6",\r\n          color7: "color7",\r\n          color8: "color8",\r\n          color9: "color9",\r\n          color10: "color10",\r\n          color11: "color11",\r\n          color12: "color12",\r\n          color13: "color13",\r\n          color14: "color14",\r\n          color15: "color15",\r\n          color16: "color16",\r\n          color17: "color17"\r\n        };\r\n        var taskNames = workers;\r\n        tasks.sort(function(a, b) {\r\n          return a.endDate - b.endDate;\r\n        });\r\n        var maxDate = tasks[tasks.length - 1].endDate;\r\n        tasks.sort(function(a, b) {\r\n          return a.startDate - b.startDate;\r\n        });\r\n        var minDate = tasks[0].startDate;\r\n\r\n        var format = "%H:%M";\r\n\r\n        var gantt = d3\r\n          .gantt()\r\n          .taskTypes(taskNames)\r\n          .taskStatus(taskStatus)\r\n          .tickFormat(format);\r\n        gantt(tasks);\r\n      }, 2000);\r\n    },\r\n    Numberorders() {\r\n      var _that = this;\r\n      var date = _that.getNowFormatDate();\r\n      _that.$axios\r\n        .get(_that.$api + "/api/sch/jobs_count_today?workday=" + date)\r\n        .then(res => {\r\n          _that._data.sent_list = res.data.done_jobs_count;\r\n          _that._data.general_order = res.data.jobs_count;\r\n          _that._data.pending_number = res.data.pre_jobs_count;\r\n        });\r\n    }\r\n  }\r\n};\r\n<\/script>\r\n\r\n<style scoped>\r\nh2 {\r\n  color: #b1afaf;\r\n  line-height: 80px;\r\n  text-align: left;\r\n  padding-left: 20px;\r\n  border-bottom: 1px solid #dee2e6;\r\n  box-shadow: 0px 7px 7px -7px #5e5e5e;\r\n}\r\n\r\n.todayclub {\r\n  margin-top: 70px;\r\n}\r\n.el-row {\r\n  margin-bottom: 20px;\r\n  &:last-child {\r\n    margin-bottom: 0;\r\n  }\r\n}\r\n.el-col {\r\n  border-radius: 4px;\r\n}\r\n.block1 {\r\n  color: white;\r\n  background: #1b88e5;\r\n}\r\n.block2 {\r\n  color: white;\r\n  background: #7560ed;\r\n}\r\n.block3 {\r\n  color: white;\r\n  background: #26c5d8;\r\n}\r\n.h5 {\r\n  text-indent: 1em;\r\n  text-align: left;\r\n  font-size: 14px;\r\n  line-height: 40px;\r\n  margin: 0;\r\n}\r\n.ordernumber {\r\n  font-size: 40px;\r\n  line-height: 60px;\r\n}\r\n.remarks {\r\n  font-size: 12px;\r\n}\r\n#myChart {\r\n  float: left;\r\n}\r\n#hourcontrast {\r\n  float: right;\r\n}\r\n</style>\r\n'],sourceRoot:""}])},x0vE:function(r,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e={name:"AdminHome",data:function(){return{colors:["color1","color2","color3","color4","color5","color6","color7","color8","color9","color10","color11","color12","color13","color14","color15","color16","color17"],data:[99,71,78,25,36,92],line:"",general_order:"123",sent_list:"456",pending_number:"789"}},created:function(){},mounted:function(){this.Numberorders(),this.drawLine(),this.hourcontrast(),this.calculatePath()},methods:{drawLine:function(){this.$echarts.init(document.getElementById("myChart")).setOption({title:{text:"区域订单",subtext:"工时需求",x:"center"},tooltip:{trigger:"item",show:!0},grid:{show:!0,left:"3%",right:"4%",bottom:"3%",containLabel:!0,backgroundColor:"#e4e4e6",x:40,x2:100,y2:150},legend:{data:["销量"],left:"10%",top:"10%"},xAxis:{type:"category",data:["2019-03-1706:00:00","2019-03-17 07:00:00","2019-03-17 08:00:00","2019-03-17 09:00:00","2019-03-17 10:00:00","2019-03-1706:00:00","2019-03-17 07:00:00","2019-03-17 08:00:00","2019-03-17 09:00:00","2019-03-17 10:00:00"],axisTick:{alignWithLabel:!0},splitLine:{show:!1,interval:"auto",lineStyle:{color:["#315070"],width:1,type:"solid"}},axisLabel:{interval:0,rotate:90}},yAxis:{type:"value"},series:[{name:"销量",type:"bar",data:[.27,.76,1.29,1.94,2.11,.27,.76,1.29,1.94,2.11],itemStyle:{color:"#e54933"}}]})},hourcontrast:function(){var r=[],t={};this.$axios.get(this.$api+"/api/sch/compare_worker_job").then(function(n){for(var e in n.data.jobs_hrs)t.product=e,t.jobs_hrs=n.data.jobs_hrs[e],t.workers_hrs=n.data.workers_hrs[e],r.push(t),t={}}),this.$echarts.init(document.getElementById("hourcontrast")).setOption({title:{text:"区域洗车",subtext:"工时需求 和 工人工时",x:"center"},grid:{show:!0,backgroundColor:"#e4e4e6",x:40,x2:100,y2:150},legend:{left:"10%",top:"10%"},tooltip:{show:!0},dataset:{dimensions:["product","jobs_hrs","workers_hrs"],source:r},xAxis:{type:"category",axisTick:{alignWithLabel:!0},axisLabel:{interval:0,rotate:90}},yAxis:{},series:[{type:"bar"},{type:"bar",barGap:"0%",itemStyle:{color:"#1b88e5"}}]})},calculatePath:function(){var r=this,t=this,n=t.getNowFormatDate(),e=[],o=[],a={};t.$axios.post(t.$api+"/api/sch/load_by_region",{workday:n}).then(function(n){if(null!==n.data.jobs){for(var s=0;s<n.data.jobs.length;s++)a.startDate=new Date(n.data.jobs[s].start_time),a.endDate=new Date(n.data.jobs[s].end_time),a.taskName=n.data.jobs[s].worker_id,a.status=t._data.colors[a.taskName],o.push(a),a={};for(s=0;s<n.data.workers.length;s++)e.push(n.data.workers[s].worker_id);t.playgantt(o,e)}else r.$message({showClose:!0,message:"今日无单!"})})},getNowFormatDate:function(){var r=new Date,t=r.getFullYear(),n=r.getMonth()+1,e=r.getDate();return n>=1&&n<=9&&(n="0"+n),e>=0&&e<=9&&(e="0"+e),t+"-"+n+"-"+e},playgantt:function(r,t){var n=r;setTimeout(function(){var r=t;n.sort(function(r,t){return r.endDate-t.endDate});n[n.length-1].endDate;n.sort(function(r,t){return r.startDate-t.startDate});n[0].startDate;d3.gantt().taskTypes(r).taskStatus({color1:"color1",color2:"color2",color3:"color3",color4:"color4",color5:"color5",color6:"color6",color7:"color7",color8:"color8",color9:"color9",color10:"color10",color11:"color11",color12:"color12",color13:"color13",color14:"color14",color15:"color15",color16:"color16",color17:"color17"}).tickFormat("%H:%M")(n)},2e3)},Numberorders:function(){var r=this,t=r.getNowFormatDate();r.$axios.get(r.$api+"/api/sch/jobs_count_today?workday="+t).then(function(t){r._data.sent_list=t.data.done_jobs_count,r._data.general_order=t.data.jobs_count,r._data.pending_number=t.data.pre_jobs_count})}}},o=function(){var r=this,t=r.$createElement,n=r._self._c||t;return n("div",{staticClass:"home"},[n("h2",[r._v("Welcome")]),r._v(" "),n("div",{staticClass:"todayclub"},[n("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-around"}},[n("el-col",{staticClass:"block1",attrs:{span:5}},[n("h5",{staticClass:"h5"},[r._v("总订单数")]),r._v(" "),n("div",{staticClass:"ordernumber"},[r._v(r._s(r.general_order))]),r._v(" "),n("p",{staticClass:"remarks"},[r._v("GENERAL ORDER")])]),r._v(" "),n("el-col",{staticClass:"block2",attrs:{span:5}},[n("h5",{staticClass:"h5"},[r._v("已派单数")]),r._v(" "),n("div",{staticClass:"ordernumber"},[r._v(r._s(r.sent_list))]),r._v(" "),n("p",{staticClass:"remarks"},[r._v("SENT LIST")])]),r._v(" "),n("el-col",{staticClass:"block3",attrs:{span:5}},[n("h5",{staticClass:"h5"},[r._v("待派单数")]),r._v(" "),n("div",{staticClass:"ordernumber"},[r._v(r._s(r.pending_number))]),r._v(" "),n("p",{staticClass:"remarks"},[r._v("PENDING NUMBER")])])],1)],1),r._v(" "),n("div",{staticClass:"echats"},[n("div",{style:{width:"50%",height:"600px"},attrs:{id:"myChart"}}),r._v(" "),n("div",{style:{width:"50%",height:"600px"},attrs:{id:"hourcontrast"}})]),r._v(" "),n("div",{attrs:{id:"workerss"}})])};o._withStripped=!0;var a={render:o,staticRenderFns:[]},s=a;var l=!1;var i=n("VU/8")(e,s,!1,function(r){l||n("yd/z")},"data-v-2ba5fe30",null);i.options.__file="src/views/admin/index.vue";t.default=i.exports},"yd/z":function(r,t,n){var e=n("kfBU");"string"==typeof e&&(e=[[r.i,e,""]]),e.locals&&(r.exports=e.locals);n("rjj0")("da773b20",e,!1,{})}});
//# sourceMappingURL=19.68d7672277e92281b4aa.js.map